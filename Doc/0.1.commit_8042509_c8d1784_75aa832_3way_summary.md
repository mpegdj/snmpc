# 0.1 커밋 3개 정리 (8042509 / c8d1784 / 75aa832) - MIB Tree/파싱 중심

대상 커밋:

- `8042509` : `snmp test get next walk`
- `c8d1784` : `snmp test get next walk md`
- `75aa832` : `nel child disappear`

---

## 0) 결론(한 줄)

- **정상 기준을 `c8d1784`로 본다면**, `75aa832`에서의 `nel child disappear`는 “문서만 바뀐 게 아니라” **MIB 파싱/정리/트리 생성/필터(UI 표시)** 코드가 바뀌며 발생 가능한 구조가 만들어진 결과다.

---

## 1) 각 커밋의 성격(요약)

### 1.1 `8042509` (snmp test get next walk)

- “SNMP Test” 기능 축을 확장/정리해가던 시점의 베이스 커밋
- 이 시점에는 후속 커밋에서 추가되는 MIB View 필터(`IsVisible`) 및 파싱 필터 강화가 아직 본격화되기 전 단계로 볼 수 있음

### 1.2 `c8d1784` (snmp test get next walk md)  ← 사용자 기준 “정상”

- 커밋 메시지에 `md`가 포함되어 있어 문서 변경이 큰 축이지만,
  - 이후 커밋(`75aa832`)과 비교하면 **MIB 파싱/필터 관련 변화가 아직 들어오기 전(또는 덜 공격적인 상태)**로 간주됨
- 사용자 경험상 이 커밋까지는 MIB Tree가 “깨지지 않는다”는 기준점

### 1.3 `75aa832` (nel child disappear)  ← 문제 커밋

아래 변화들이 결합되며 “`nel` 하위가 사라짐/비어보임/오염된 이름(IMPORTS 등)” 문제가 발생할 여지가 커짐.

- **MIB 파싱/정리(Infra)에서 ‘소문자 시작 강제’가 3단으로 걸림**
  - `ParseMibFile` 정규식: `[a-z]...` 형태로 소문자 시작만 매칭
  - `Register`: 소문자 시작이 아니면 등록 스킵
  - `CleanInvalidOidNames`: `!char.IsLower(name[0])` 조건으로 대문자 시작 이름을 대량 제거
- **UI 필터(IsVisible) 도입**
  - `MibTreeNode.IsVisible` 추가
  - `SidebarMibView`에서 `Visibility` 바인딩
  - `MainWindow`에서 디바이스 `SysObjectId` 기반으로 Private subtree를 필터링

---

## 2) 3-way 비교 포인트(핵심만)

### 2.1 “MIB Tree가 깨져 보이는” 두 가지 경로

1) **파싱/정리로 `_oidToName`에 구멍이 나서** 애초에 subtree가 빈약하게 생성됨  
2) subtree는 있어도 **필터로 `IsVisible=false`가 되어 UI에서 숨겨짐**

`75aa832`는 위 두 경로가 모두 활성화된 형태라, “nel child disappear” 증상이 더 쉽게 발생/관찰될 수 있음.

### 2.2 “md만 바뀐 것 같다” 가설에 대한 정리

`c8d1784 → 75aa832` 사이에는 문서 뿐 아니라 다음 코드들이 변경됨:

- `SnmpNms.Infrastructure/MibService.cs` (파싱/정리/트리 빌드 로직)
- `SnmpNms.Core/Models/MibTreeNode.cs` (`IsVisible`)
- `SnmpNms.UI/Views/SidebarMibView.xaml` (Visibility 바인딩)
- `SnmpNms.UI/MainWindow.xaml.cs` (MIB 트리 연결/필터/선택 연동)

즉 “md만”이 아니라 **문제의 원인이 될 수 있는 코드 변화가 포함**되어 있다.

---

## 3) 어디 문서를 보면 되나(이미 만든 문서들: 삭제하지 않음)

- **`75aa832` vs `8042509` 비교(파싱 중심)**:
  - `Doc/0.1.commit75aa832 vs 8042509 comparison.md`
- **`75aa832` vs `c8d1784` 비교(정상 기준을 c8로 둘 때)**:
  - `Doc/0.1.commit75aa832 vs c8d1784 comparison (MIB Tree 깨짐-파싱 중심).md`
- **증상/원인 후보/작업 이력(이슈 중심)**:
  - `Doc/14.mib_view_nel_child_disappear.md`
  - `Doc/15.mib_tree_bug_analysis.md`

---

## 4) 다음 액션(선택)

- **(A)** `c8d1784`를 “정상 기준”으로 확정하고, `75aa832`의 파싱/정리/필터 변경을 되돌려서 “문제 해결 커밋”을 만들기
- **(B)** `75aa832` 유지 + 로깅/검증을 강화해서 실제로 “파싱 누락 vs 필터 숨김” 중 무엇이 주원인인지 확정하기


