# 로그 관리 기능 강화 및 UI 통합 (v1.6)

에디터 영역의 'Event Log'와 하단 패널의 'Log' 기능을 통일하고, 1000라인 제한 및 파일 저장 기능을 추가했습니다.

## 주요 변경 사항 요약
1. **로그 통합**: 에디터와 하단 탭 모두 Trap/Polling 로그만 표시하도록 기준 통일.
2. **시스템 로그 분리**: `[System]` 로그는 트래픽 로그에서 제외, 'Debug' 탭으로만 전송.
3. **UI 간소화**: 에디터의 불필요한 설정 제거, 하단 탭과 디자인 통일.
4. **기능 강화**: 모든 탭에 1000라인 제한, Clear, Save(파일/CSV) 기능 적용.

---

## 상세 코드 변경 내역 (Before / After)

### 1. [MainViewModel.cs](file:///d:/git/snmpc/SnmpNms.UI/ViewModels/MainViewModel.cs)
**변경 내용**: `[System]` 메시지 분리 및 트래픽 로그 전용 처리.

#### [Before]
```csharp
public void AddEvent(EventSeverity severity, string? device, string message)
{
    var entry = new EventLogEntry(DateTime.Now, severity, device, message);
    System.Windows.Application.Current.Dispatcher.Invoke(() =>
    {
        Events.Add(entry);
        if (Events.Count > LogSaveService.MaxLinesInMemory) Events.RemoveAt(0);
        CurrentLog.Refresh();
    });
    if (LogSaveService.IsEnabled) LogSaveService.SaveLogEntry(entry);
    if (message.StartsWith("[System]", StringComparison.OrdinalIgnoreCase)) Debug.LogSystem(message);
}
```

#### [After]
```csharp
public void AddEvent(EventSeverity severity, string? device, string message)
{
    // System 메시지는 Debug에만 기록하고 트래픽 로그(Events)에는 넣지 않음
    if (message.StartsWith("[System]", StringComparison.OrdinalIgnoreCase))
    {
        Debug.LogSystem(message);
        return;
    }

    var entry = new EventLogEntry(DateTime.Now, severity, device, message);
    System.Windows.Application.Current.Dispatcher.Invoke(() =>
    {
        Events.Add(entry);
        if (Events.Count > LogSaveService.MaxLinesInMemory) Events.RemoveAt(0);
        CurrentLog.Refresh();
    });
    if (LogSaveService.IsEnabled) LogSaveService.SaveLogEntry(entry);
}
```

---

### 2. [EventLogEntry.cs](file:///d:/git/snmpc/SnmpNms.UI/Models/EventLogEntry.cs)
**변경 내용**: 트래픽 로그 판별을 위한 공용 헬퍼 메서드 추가.

#### [Before]
```csharp
public class EventLogEntry
{
    // ... Properties and Constructor ...
}
```

#### [After]
```csharp
public class EventLogEntry
{
    // ... Properties and Constructor ...

    public static bool IsTrafficLog(string message)
    {
        if (string.IsNullOrEmpty(message)) return false;
        if (message.StartsWith("[Trap", StringComparison.OrdinalIgnoreCase)) return true;
        if (message.Contains("Polling", StringComparison.OrdinalIgnoreCase) || 
            message.Contains("Poll ", StringComparison.OrdinalIgnoreCase)) return true;
        return false;
    }
}
```

---

### 3. [EventLogFilterViewModel.cs](file:///d:/git/snmpc/SnmpNms.UI/ViewModels/EventLogFilterViewModel.cs)
**변경 내용**: 에디터 'Event Log' 탭에 트래픽 로그 필터 적용.

#### [Before]
```csharp
private bool FilterPredicate(object obj)
{
    if (obj is not EventLogEntry e) return false;
    // ... 기존 MapNode 기반 필터링 ...
}
```

#### [After]
```csharp
private bool FilterPredicate(object obj)
{
    if (obj is not EventLogEntry e) return false;
    // 순수하게 트래픽(Trap, Polling) 로그만 표시
    if (!EventLogEntry.IsTrafficLog(e.Message)) return false;
    // ... 기존 MapNode 기반 필터링 ...
}
```

---

### 4. [EventLogTabControl.xaml](file:///d:/git/snmpc/SnmpNms.UI/Views/EventLog/EventLogTabControl.xaml)
**변경 내용**: 상단 Status Bar UI 간소화 (하단 탭과 통일).

#### [Before]
```xml
<StackPanel Grid.Column="3" Orientation="Horizontal" VerticalAlignment="Center">
    <TextBlock Text="Lines:" ... />
    <TextBox x:Name="txtLogMaxLines" ... />
    <CheckBox x:Name="chkLogSave" ... />
    <Separator ... />
    <Button x:Name="btnEventClear" ... />
    <Button x:Name="btnEventSave" ... />
</StackPanel>
```

#### [After]
```xml
<StackPanel Grid.Column="3" Orientation="Horizontal" VerticalAlignment="Center">
    <Separator ... />
    <Button x:Name="btnEventClear" ... />
    <Button x:Name="btnEventSave" ... />
</StackPanel>
```

---

### 5. [EventLogTabControl.xaml.cs](file:///d:/git/snmpc/SnmpNms.UI/Views/EventLog/EventLogTabControl.xaml.cs)
**변경 내용**: 삭제된 UI 컨트롤(Lines, Save)에 대한 바인딩 코드 제거.

#### [Before]
```csharp
// 저장 설정 바인딩
if (txtLogMaxLines != null) {
    var maxLinesBinding = new Binding("LogSaveService.MaxLinesInMemory") { ... };
    txtLogMaxLines.SetBinding(TextBox.TextProperty, maxLinesBinding);
}
if (chkLogSave != null) {
    var saveBinding = new Binding("LogSaveService.IsEnabled") { ... };
    chkLogSave.SetBinding(CheckBox.IsCheckedProperty, saveBinding);
}
```

#### [After]
```csharp
// (해당 블록 삭제됨)
Tag = mainVm;
mainVm.PropertyChanged += MainViewModel_PropertyChanged;
```

---

### 6. [LogViewModel.cs](file:///d:/git/snmpc/SnmpNms.UI/ViewModels/LogViewModel.cs)
**변경 내용**: 트래픽 로그 판별 로직을 `EventLogEntry.IsTrafficLog`로 일원화.

#### [Before]
```csharp
private bool IsTrapOrPollingLog(EventLogEntry entry)
{
    if (entry == null || string.IsNullOrEmpty(entry.Message)) return false;
    var message = entry.Message;
    if (message.StartsWith("[Trap", StringComparison.OrdinalIgnoreCase)) return true;
    if (message.Contains("Polling", StringComparison.OrdinalIgnoreCase) ||
        message.Contains("Poll", StringComparison.OrdinalIgnoreCase)) return true;
    return false;
}
// SaveToFile 메서드 없음
```

#### [After]
```csharp
private bool IsTrapOrPollingLog(EventLogEntry entry)
{
    return EventLogEntry.IsTrafficLog(entry.Message);
}

public void SaveToFile()
{
    var sfd = new Microsoft.Win32.SaveFileDialog { Filter = "Text Files (*.txt)|*.txt", ... };
    if (sfd.ShowDialog() == true) {
        var sb = new StringBuilder();
        foreach (var log in LogEntries) sb.AppendLine(...);
        File.WriteAllText(sfd.FileName, sb.ToString());
    }
}
```

---

### 7. [DebugViewModel.cs](file:///d:/git/snmpc/SnmpNms.UI/ViewModels/DebugViewModel.cs) & [ComViewModel.cs](file:///d:/git/snmpc/SnmpNms.UI/ViewModels/ComViewModel.cs)
**변경 내용**: 각 ViewModel에 1000라인 제한 로직 적용 및 `SaveToFile` 구현.

#### [After (공통 로직)]
```csharp
private void AddLog(...) {
    // UI 스레드에서 실행
    System.Windows.Application.Current?.Dispatcher.Invoke(() => {
        Logs.Add(entry);
        while (Logs.Count > 1000) Logs.RemoveAt(0); // 1000라인 제한
    });
}

public void SaveToFile() {
    // SaveFileDialog를 통한 텍스트 내보내기 구현
}
```

---

### 8. [Panel.xaml](file:///d:/git/snmpc/SnmpNms.UI/Views/Panel.xaml)
**변경 내용**: 하단 패널 각 탭(Log, Debug, Com)의 툴바에 관리 버튼 배치.

#### [Before (Log 탭 예시)]
```xml
<StackPanel Orientation="Horizontal">
    <Button Content="Clear" Click="BtnLogClear_Click" ... />
    <CheckBox x:Name="chkLogAutoScroll" ... />
</StackPanel>
```

#### [After (Log 탭 예시)]
```xml
<StackPanel Orientation="Horizontal">
    <Button Content="Clear" ... />
    <Button Content="Copy" Click="BtnLogCopy_Click" ... /> <!-- 추가 -->
    <Button Content="Save" Click="BtnLogSave_Click" ... /> <!-- 추가 -->
    <CheckBox x:Name="chkLogAutoScroll" ... />
</StackPanel>
```

---

### 9. [Panel.xaml.cs](file:///d:/git/snmpc/SnmpNms.UI/Views/Panel.xaml.cs)
**변경 내용**: 버튼 핸들러 추가 및 빌드 오류 대응(타입 명시화).

#### [After]
```csharp
private void BtnLogSave_Click(object sender, RoutedEventArgs e) => _logViewModel?.SaveToFile();
private void BtnComSave_Click(object sender, RoutedEventArgs e) => _comViewModel?.SaveToFile();
private void BtnDebugSave_Click(object sender, RoutedEventArgs e) => _debugViewModel?.SaveToFile();

// Copy 시 타입 명시 (충돌 방지)
if (item is SnmpNms.UI.Models.EventLogEntry evLogEntry) { ... }
```

---

## 현재 진행 상황 및 이슈 (빌드 중단)
현재 WPF 임시 프로젝트(`_wpftmp`) 빌드 중 `Entry`라는 멤버를 찾을 수 없다는 오류가 반복되고 있습니다.

1. **원인 추정**: WPF의 비하인드 코드 생성 과정에서 `EventLogEntry` 타입명이 어떠한 이유로 `Entry`로 축약되어 해석되거나, 네임스페이스 해석 오류가 발생한 것으로 보입니다.
2. **조치 중**: 
    - 모든 `EventLogEntry` 관련 로컬 변수명을 `evLogEntry`로 변경.
    - `SnmpNms.UI.Models.EventLogEntry`와 같이 풀 네임스페이스를 사용하여 모호성 제거.
    - 빌드 클린 및 재시도를 통한 상태 확인 예정.


## 의심되는 DataTemplate (Panel.xaml)
WPF 임시 프로젝트 빌드 시 `Entry` 멤버 관련 오류가 발생하는 것과 관련하여, `Panel.xaml`의 `lvCom` 섹션에 있는 아래 `DataTemplate`이 의심됩니다. 

```xml
<!-- SnmpNms.UI\Views\Panel.xaml (Line 181-188) -->
<GridViewColumn.CellTemplate>
    <DataTemplate>
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding Summary}" Foreground="Black"/>
        </StackPanel>
    </DataTemplate>
</GridViewColumn.CellTemplate>
```

> [!NOTE]
> `_wpftmp.cs` 파일에서 발생하는 정확한 오류 라인은 사용자의 추가 확인이 필요합니다. 현재까지의 정보로는 바인딩 과정에서의 타입 추론 오류가 가장 유력한 원인으로 보입니다.

(base) PS D:\git\snmpc> dotnet build SnmpNms.UI        
복원 완료(0.4초)
  SnmpNms.Core 성공 (0.0초) → SnmpNms.Core\bin\Debug\net9.0\SnmpNms.Core.dll
  SnmpNms.Infrastructure 성공 (0.2초) → SnmpNms.Infrastructure\bin\Debug\net9.0\SnmpNms.Infrastructure.dll
  SnmpNms.UI_sdxeutqr_wpftmp 1 오류와 함께 실패 (2.5초)
    D:\git\snmpc\SnmpNms.UI\ViewModels\MainViewModel.cs(197,42): error CS1061: 'EventLogEntry'에는 'TimestampString'에 대한 정의가 포함되어 있지 않고, 'EventLogEntry' 형식의 첫 번째 인 수를 허용하는 액세스 가능한 확장 메서드 'TimestampString'이(가) 없습니다. using 지시문 또는 어셈블리 참조가 있는지 확인하세요.

1 오류와 함께 실패 빌드(3.8초)
(base) PS D:\git\snmpc> 

# 빌드 오류 최종 분석 및 정답 해결책

## 1. 진짜 원인 (100% 확신)
에러 메시지: `'EventLogEntry'에는 'TimestampString'에 대한 정의가 포함되어 있지 않습니다.`

**원인**: 
`SnmpNms.UI.Models.EventLogEntry`와 .NET 기본 클래스인 `System.Diagnostics.EventLogEntry` 사이의 **이름 충돌**입니다. `MainViewModel.cs` 등에서 `System.Diagnostics`가 참조되면서, 컴파일러가 우리가 만든 모델이 아닌 .NET의 `EventLogEntry`를 참조하게 되었고, 해당 클래스에는 `TimestampString` 프로퍼티가 없기 때문에 빌드 오류가 발생했습니다.

## 2. 해결책: 모델 이름 변경 (Rename)
이름 충돌을 원천 차단하기 위해 모델 이름을 더 구체적으로 변경합니다.

- **변경 전**: `EventLogEntry`
- **변경 후**: `SnmpEventLog`

또한, 데이터 바인딩 및 파일 저장에 필요한 프로퍼티를 명확히 정의합니다.
- `TimestampString`: `yyyy-MM-dd HH:mm:ss` 형식의 포맷된 문자열.
- `Summary`: 로그 메시지 요약 (필요 시).

## 3. 실행 내용
- [x] `SnmpNms.UI.Models.EventLogEntry` -> `SnmpEventLog`로 이름 변경.
- [x] 모든 관련 ViewModel 및 XAML 비하인드 코드의 참조 업데이트.
- [x] 필요한 프로퍼티(`TimestampString`, `Summary`) 추가.
- [x] 프로젝트 빌드 확인.

---

# 트랩 데이터 번역 및 표시 개선

## 1. 개요
트랩 수신 시 복잡한 OID 숫자 대신 인간이 읽기 쉬운 텍스트(예: Login, Logout 등)로 표시하고, 누락되었던 트랩 상세 변수들을 이벤트 로그에서 확인할 수 있도록 개선했습니다.

## 2. 주요 변경 사항

### 1) 트랩 이름 번역 (MIB 활용)
- **위치**: `MainWindow.xaml.cs`의 `TrapListener_OnTrapReceived`
- **내용**: `_mibService.GetOidName(trapOid)`를 호출하여 OID를 텍스트로 번역. 예: `1.3.6.1.4.1.1.1.1.1` -> `authenticationFailure`.

### 2) 상세 변수(Variables) 로그 추가 및 필터 수정
- **로그 내용**: 트랩 아래에 각 변수의 이름(번역됨)과 값을 표시 (`  [Trap] sysLocation.0 = Seoul`).
- **필터 수정**: `SnmpEventLog.IsTrafficLog` 로직을 수정하여 앞에 공백이 있는(들여쓰기 된) 상세 로그도 "Log" 탭에 정상적으로 표시되도록 허용.

### 3) Com 탭 분석 환경 유지
- **전략**: 이벤트 로그 탭은 '가공된 텍스트' 중심, Com 탭은 'Raw 데이터 및 OID' 중심의 이원화된 표시 체계 구축.

## 3. 실행 결과
- [x] 트랩 수신 시 MIB 번역 이름으로 제목 표시.
- [x] 트랩 하단에 상세 변수(최대 10개) 들여쓰기 로그 표시.
- [x] 필터 수정을 통한 로그 누락 현상 해결.
- [x] 빌드 및 실행 확인.

---

# Com 탭 UI 및 가독성 개선

## 1. 개요
통신 로그를 표시하는 Com 탭의 데이터 그리드 구조를 개선하여 OID 정보를 더 쉽게 확인하고, 불필요하게 중복되는 정보를 제거하여 화면 공간을 효율적으로 사용하도록 수정했습니다.

## 2. 주요 변경 사항

### 1) OID 전용 컬럼 추가
- **위치**: `Panel.xaml` (하단 패널의 Com 탭)
- **내용**: `Target` 컬럼 뒤에 `OID` 컬럼을 신설하여 트랩이나 요청의 대상 OID를 한눈에 볼 수 있게 했습니다.

### 2) 요약(Summary) 정보 정리
- **위치**: `ComLogEntry.cs` (ViewModel)
- **내용**: 이미 컬럼으로 존재하는 `Direction`([in]/[out])과 `Target`(IP:Port) 정보를 요약 텍스트에서 제거했습니다. 
- **결과**: `45 bytes: .0..1.3.6.1...` 와 같이 데이터 크기와 미리보기 위주로 간결하게 표시됩니다.

### 3) 데이터 연동 강화
- **내용**: 트랩 수신 시 해당 트랩의 대표 OID를 Com 탭의 OID 컬럼에 함께 기록하도록 `MainWindow.xaml.cs` 로직을 업데이트했습니다.

## 3. 실행 결과
- [x] Com 탭에 OID 컬럼 정상 노출 확인.
- [x] 요약 열에서 중복 주소 제거 및 가독성 향상.
- [x] 빌드 및 동작 확인.

---

# 트랩 로그 단일행 병합 및 요약 개선

## 1. 개요
동일한 트랩 패킷에 포함된 여러 상세 변수(Variables)들이 여러 줄로 나뉘어 표시되던 문제를 해결하고, 이벤트 로그와 Com 탭 모두에서 핵심 값 위주의 단일행 요약 정보를 제공하도록 개선했습니다.

## 2. 주요 변경 사항

### 1) 이벤트 로그 단일행 병합
- **기존**: 제목 1줄 + 상세 변수 N줄 (총 N+1줄).
- **변경**: 상세 변수들의 값(Value)만 추출하여 `[트랩이름]: [값1] / [값2] ...` 형태로 병합하여 1줄로 표시.

### 2) Com 탭 요약(Summary) 정보 가치 제고
- **변경**: 패킷 크기/미리보기 대신, 실제 데이터 값들을 병합한 텍스트를 최우선으로 표시하도록 `ComLogEntry.Description` 필드 추가 및 연동.

### 3) 코드 통합
- `MainWindow.xaml.cs`의 `TrapListener_OnTrapReceived`에서 로그 생성 로직을 일원화하여 두 탭 간 정보의 일치성 확보.

## 3. 실행 결과
- [x] 이벤트 로그 탭에서 MVE5000 트랩이 단 1행으로 표시됨 확인.
- [x] Com 탭 요약 열에서도 `Summary` 대신 실제 데이터 값(Value)들이 표시됨 확인.
- [x] 빌드 및 동작 무결성 확인.

---

# 트랩 로그 프리픽스 및 장비 식별 개선

## 1. 개요
로그의 시인성을 높이기 위해 모든 트랩 로그에 붙던 정형화된 `[Trap]` 태그를 제거하고, 실제 장비명이나 모델명(예: `[mve5000]`)을 프리픽스로 사용하도록 개선했습니다.

## 2. 주요 변경 사항

### 1) 장비 식별 로직 (Smart Identification)
수신된 트랩의 소스 IP와 OID 정보를 결합하여 최적의 이름을 찾아냅니다.
- **1순위**: 프로그램에 등록된 장비 중 IP가 일치하는 장비의 'Alias(별칭)' 또는 'Device(기기명)' 사용.
- **2순위**: 등록되지 않은 장비인 경우, 트랩 OID 이름에서 모델명 추출 (예: `mve5000Trap...` → `mve5000`).
- **3순위**: 추출 실패 시 트랩 이름 전체 또는 'Unknown' 사용.

### 2) 로그 포맷 변경
- **기본**: `[장비명]: 값1 / 값2 / ...`
- **예시**: `[mve5000]: 2025-12-29 01:05:19 / 525 / 7 / 8 / Parameters successfully applied`

## 3. 실행 결과
- [x] 불필요한 `[Trap]` 태그 제거 완료.
- [x] 등록된 장비명 또는 OID 기반 모델명이 대괄호`[]` 안에 표시됨 확인.
- [x] 한 줄 병합 및 값 위주 표시 유지.
- [x] 빌드 성공 확인.

---

# 이벤트 로그 필터 누락 버그 수정 (Hotfix)

## 1. 문제 현상
트랩 로그의 프리픽스를 `[Trap]`에서 `[mve5000]` 등으로 변경한 후, 이벤트 로그(Log) 탭에서 해당 로그들이 더 이상 표시되지 않는 현상이 발생했습니다.

## 2. 원인 분석
기존 `SnmpEventLog.IsTrafficLog` 필터 로직이 메시지가 반드시 `[Trap]`으로 시작해야만 트래픽 로그로 인정하고 필터링을 통과시켰기 때문입니다. 프리픽스 변경으로 인해 이 조건이 만족되지 않았습니다.

## 3. 해결책 및 구현
- **필터 로직 유연화**: 
  - `SnmpEventLog.cs`에서 `IsTrafficLog` 메서드를 수정했습니다.
  - 이제 대괄호(`[` )로 시작하는 모든 메시지를 트래픽 로그로 간주합니다.
  - 단, 시스템 로그와의 혼선을 방지하기 위해 `[System]`으로 시작하는 경우는 제외합니다.
- **결과**: `[mve5000]`, `[mve5100]` 등 다양한 장비명 프리픽스가 붙은 로그들이 "Log" 탭에 정상적으로 노출됩니다.

## 4. 확인 사항
- [x] `[mve5000]: ...` 형식의 로그가 "Log" 탭에 표시됨 확인.
- [x] 빌드 및 실행 완료.

---

# 로그 프리픽스 통합 및 필터 최적화

## 1. 개요
로그의 종류(트랩, 폴링)를 명확히 구분하고 필터링 성능을 최적화하기 위해 체계화된 프리픽스 시스템을 도입했습니다.

## 2. 주요 변경 사항

### 1) 프리픽스 표준화
- **트랩(Trap)**: `[T:장비명]` 형식 도입 (예: `[T:mve5000]`)
- **폴링(Polling)**: `[P:장비명]` 형식 도입 (예: `[P:mve5000]`)
- 트기 사항: 장비명이 없는 경우 IP 주소가 자동으로 사용됩니다.

### 2) 필터 로직 고도화
- `SnmpEventLog.IsTrafficLog` 메서드에서 `[T:` 또는 `[P:` 로 시작하는지 여부만 체크하도록 변경하여 필터링 속도와 정확도를 향상시켰습니다.

### 3) 일관된 적용
- `MainWindow.xaml.cs`의 트랩 수신부와 폴링 결과 처리부 모두에 새로운 형식을 적용했습니다.

## 3. 실행 결과
- [x] 트랩 수신 시 `[T:mve5000]: ...` 형식으로 표시됨 확인.
- [x] 폴링 실패 시 `[P:장비명]: Down...` 형식으로 표시됨 확인.
- [x] "Log" 탭 필터링 정상 작동 및 빌드 성공 확인.

---

# 기기명 결정 우선순위 최적화 (Alias 최우선)

## 1. 개요
로그 프리픽스(`[T:]`, `[P:]`)에 표시되는 기기 이름을 결정할 때, 사용자가 설정한 별칭(`Alias`)을 가장 높은 우선순위로 사용하도록 로직을 강화했습니다.

## 2. 이름 결정 로직 (Priority)
로그에 표시될 이름은 다음 순서에 따라 결정됩니다:
1. **1순위 (Alias)**: 사용자가 기기에 설정한 별칭.
2. **2순위 (Device)**: 기기의 모델명(기기명).
3. **3순위 (Model Parsing)**: (트랩의 경우) OID 이름에서 추출한 모델명 (예: `mve5000`).
4. **4순위 (IP Address)**: 위 정보가 모두 없는 경우 기기의 IP 주소 표시.

## 3. 적용 효과
- 사용자가 "메인-인코더"라고 Alias를 지정했다면, 모델명이 mve5000이라도 `[T:메인-인코더]`와 같이 사용자가 식별하기 가장 편한 이름으로 로그가 남습니다.
- Alias가 없는 경우에만 기존처럼 모델명이나 IP로 폴백되어 정보의 누락이 없습니다.

## 4. 확인 사항
- [x] Alias 설정 시 로그 프리픽스에 즉시 반영됨 확인.
- [x] 빌드 및 실행 무결성 확인.

---

# 빌드 에러 해결 (ISnmpTarget 타입 불일치 수정)

## 1. 문제 현상
폴링 로그 프리픽스에 `Alias`와 `Device` 속성을 적용하는 과정에서, `ISnmpTarget` 인터페이스에 해당 정의가 없어 빌드가 실패하는 현상이 발생했습니다.

## 2. 해결책
- `MainWindow.xaml.cs`에서 `e.Target`을 UI 전용 모델인 `UiSnmpTarget`으로 안전하게 다운캐스팅(Downcasting)하여 `Alias`와 `Device` 속성에 접근할 수 있도록 수정했습니다.
- 형변환 실패 시에도 시스템이 중단되지 않도록 방어적인 널 체크(Null check)와 IP 주소 폴백 로직을 적용했습니다.

---

# 최종 확인 및 완료
- [x] 트랩 로그 프리픽스 `[T:Alias]` 또는 `[T:Device]` 정상 동작.
- [x] 폴링 로그 프리픽스 `[P:Alias]` 또는 `[P:Device]` 정상 동작.
- [x] 빌드 에러 완벽 해결 및 실행 무결성 확보.
```