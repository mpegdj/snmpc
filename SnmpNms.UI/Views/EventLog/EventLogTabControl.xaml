<UserControl x:Class="SnmpNms.UI.Views.EventLog.EventLogTabControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <UserControl.Resources>
        <Storyboard x:Key="SpinnerAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="spinnerIcon"
                           Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)"
                           From="0" To="360" Duration="0:0:1"/>
        </Storyboard>
    </UserControl.Resources>
    <Grid Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Status Bar -->
        <Border Grid.Row="0" Background="#F7F7F7" BorderBrush="{StaticResource VSCodeDivider}" BorderThickness="0,0,0,1" Padding="8,6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="Status:" VerticalAlignment="Center" FontWeight="Bold" Margin="0,0,8,0"/>
                
                <!-- Polling 및 Trap 상태 및 필터링 정보 표시 -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- 회전하는 아이콘 (Polling 중일 때만 표시) -->
                    <TextBlock x:Name="spinnerIcon" 
                              Text="&#xE76C;" 
                              FontFamily="Segoe MDL2 Assets"
                              FontSize="14"
                              Foreground="{StaticResource VSCodeForeground}"
                              VerticalAlignment="Center"
                              Margin="0,0,6,0"
                              RenderTransformOrigin="0.5,0.5"
                              Visibility="{Binding Tag.IsPollingRunning, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <TextBlock.RenderTransform>
                            <RotateTransform/>
                        </TextBlock.RenderTransform>
                    </TextBlock>
                    
                    <!-- Polling 상태 텍스트 -->
                    <TextBlock Text="{Binding Tag.IsPollingRunning, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource PollingStatusConverter}}"
                              VerticalAlignment="Center"
                              Foreground="{StaticResource VSCodeForeground}"
                              Margin="0,0,12,0"/>
                    
                    <!-- Trap 상태 텍스트 -->
                    <TextBlock Text="{Binding Tag.IsTrapListening, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource TrapStatusConverter}}"
                              VerticalAlignment="Center"
                              Foreground="{StaticResource VSCodeForeground}"
                              Margin="0,0,12,0"/>
                    
                    <!-- 필터링 정보 -->
                    <TextBlock Text="{Binding FilterInfo}"
                              VerticalAlignment="Center"
                              Foreground="{StaticResource VSCodeForeground}"
                              FontStyle="Italic"/>
                </StackPanel>
                
                <!-- 필터링 정보 (우측 상단 툴바처럼 사용) -->
                <StackPanel Grid.Column="3" Orientation="Horizontal" VerticalAlignment="Center">
                    <Separator Margin="8,2" Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}"/>
                    
                    <Button x:Name="btnEventClear" Click="BtnEventClear_Click" Width="26" Height="26" Padding="4"
                            ToolTip="Clear all events" Background="Transparent" BorderThickness="0">
                        <TextBlock Text="&#xE894;" FontFamily="Segoe MDL2 Assets" FontSize="14" Foreground="#444444"/>
                    </Button>
                    <Button x:Name="btnEventSave" Click="BtnEventSave_Click" Width="26" Height="26" Padding="4"
                            ToolTip="Save log to file" Background="Transparent" BorderThickness="0">
                        <TextBlock Text="&#xE74E;" FontFamily="Segoe MDL2 Assets" FontSize="14" Foreground="#444444"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Grid -->
        <DataGrid Grid.Row="1"
                  x:Name="dataGridLog"
                  ItemsSource="{Binding View}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  HeadersVisibility="Column"
                  GridLinesVisibility="All"
                  HorizontalGridLinesBrush="{StaticResource VSCodeGridLine}"
                  VerticalGridLinesBrush="{StaticResource VSCodeGridLine}"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserResizeRows="False"
                  RowHeaderWidth="0"
                  SelectionMode="Single"
                  SelectionUnit="FullRow"
                  ScrollViewer.HorizontalScrollBarVisibility="Auto"
                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                  Background="White"
                  BorderBrush="{StaticResource VSCodeDivider}"
                  BorderThickness="0">
            <DataGrid.Resources>
                <Style TargetType="TextBlock">
                    <Setter Property="TextWrapping" Value="NoWrap"/>
                </Style>
            </DataGrid.Resources>
            <DataGrid.Columns>
                <DataGridTextColumn Header="Time" Binding="{Binding Timestamp, StringFormat=HH:mm:ss}" Width="90"/>
                <DataGridTextColumn Header="Severity" Binding="{Binding Severity}" Width="90"/>
                <DataGridTextColumn Header="Device" Binding="{Binding Device}" Width="140"/>
                <DataGridTextColumn Header="Message" Binding="{Binding Message}" Width="*"/>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</UserControl>


